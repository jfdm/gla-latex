################################################################################
# Tikz Makefile

# Author: Jan de Muijnck-Hughes
# Year: 2010

# Description: Utility Makefile that searches for all the .tikz files in the
# cwd and compiles them using pdflatex. It is assumed that each .tikz file is
# already a pdflatex suitable .tex file i.e.\ with \documentclass et al etc.
# An example of a suitable .tikz file can be found at the end of this file.
################################################################################

##
# Creates the .pdf `object' file list for use during compilation.
#
FIGURES_PDF := $(shell ls *.tex | sed 's/tikz/pdf/g' )
FIGURES_EPS := $(shell ls *.tex | sed 's/tikz/eps/g' )

phony: all build build-pdf build-eps clean really-clean

all: build clean


build-pdf: $(FIGURES_PDF)

build-eps: $(FIGURES_EPS)

build: build-pdf build-eps

##
# Compile all .tikz images using pdflatex
#
%.pdf: %.tikz
	pdflatex $<

%.eps: %.pdf
	pdftops -eps $<

##
# Remove all the cruft generated by pdflatex
#
clean:
	rm -f *.log *.aux *.out *~
##
# Remove the generated pdf images
#
really-clean: clean
	rm -f *.pdf *~ *.eps *.dvi

################################################################################
## Example .tikz file:

# \documentclass[pdftex, landscape]{article}
# \pagestyle{empty}
# \usepackage{tikz}
# ... tikz preamble i.e. styles
# \usepackage[graphics,tightpage,active]{preview}
# \PreviewEnvironment{tikzpicture}
# \begin{document}
# \centering
# \begin{tikzpicture}[scale=1]
# ... tikz contents
# \end{tikzpicture}
# \end{document}
